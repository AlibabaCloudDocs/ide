# 时间属性 {#concept_srx_kjw_p2b .concept}

本文为您介绍如何配置时间属性，包括调度周期和依赖项、是否依赖上一周期的选择。

时间属性配置页面如下所示：

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224637912_zh-CN.png)

## 节点状态 {#section_dtf_fvw_p2b .section}

-   正常调度：会按照下面的调度周期时间配置正常调度执行。任务一般默认选中此项。
-   空跑调度：会按照下面的调度周期时间配置调度但是都是空跑执行，即一调度到该任务就直接返回成功，没有真正的执行任务。
-   出错重试：节点出现错误，可重跑节点。默认出错自动重试3次，时间间隔为2分钟。
-   暂停调度：暂停调度之后，会按照下面的调度周期时间配置调度，但是一调度到该任务会直接返回失败，不会执行。一般用于某个任务暂时不用执行但后面还会继续使用的场景。

## 调度周期 {#section_fpz_kvw_p2b .section}

在DataWorks中，当一个任务被成功提交后，底层的调度系统从 第二天开始，将会每天按照该任务的时间属性生成实例，并根据上游依赖的实例运行结果和时间点运行。23:30之后提交成功的任务从第三天开始才会生成实例。

**说明：** 

若有一个任务需要每周一执行一次，那么只有运行时间是周一的情况下，该任务才会真正执行，运行时间非周一的情况下，该任务会空跑（直接将任务置为成功），不会实际运行。所以周调度任务，在测试/补数据的时候，需要选择 业务日期=运行时间-1。

一个周期运行的任务，它的依赖关系的优先级大于时间属性。在时间属性决定的某个时间点到达时，任务实例不会马上运行，而是先检查上游是否全部运行成功。

-   上游依赖的实例没有全部运行成功并且定时运行时间已到，则实例仍为未运行状态。
-   上游依赖的实例全部运行成功并且定时运行时间还未到，则实例进入等待时间状态。
-   上游依赖的实例全部运行成功并 定时运行时间已到，则实例进入 等待资源 状态准备运行。

## 依赖上一周期 {#section_qqf_xpc_kfb .section}

在使用依赖上一周期前，首先需要了解以下概念：

-   上一周期：上一个自然日产生的实例，也称之为上一周期实例。例如今天为2018年08月08日，则2018年08月07日产生的实例为上一周期实例。
-   依赖上一周期：指依赖某个父节点的上一周期实例。例如：用户配置了两个日调度节点A、B，需实现B任务实例在前一天的A任务实例运行完成后才开始运行，则可通过配置B任务依赖A任务的上一周期来实现，即配置跨周期依赖。

依赖上一周期配置如图所示。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/154202246313394_zh-CN.png)

依赖上一周期有以下三种情况：

-   一层子节点：依赖当前节点的下游，例如：节点A存在下游节点B、C、D三个节点，依赖一层子节点是节点A依赖B、C、D三个节点的上一周期。
-   本节点：依赖当前节点自己的上一周期。
-   自定义：手动输入需要依赖的其他节点，此处需要输入节点ID。如果存在多个节点，需用逗号（半角）分隔，例如： 12345,23456 。

## 天调度 {#section_o21_jrx_p2b .section}

天调度任务，即每天自动运行一次。新建周期任务时，默认的时间周期为每天0点运行一次，可根据需要自行指定运行时间点，例如下图指定每天13点运行一次。

1.  当不勾选定时调度，则每日任务实例定时时间——当天日期 年-月-日，默认调度时间，从0点到0点30分随机生成。
2.  当勾选定时调度，则每日任务实例定时时间为——当天日期 年-月-日 定时时：分：秒。任务要调度需满足两个条件才能跑起（上游任务执行成功以及定时时间到），任何一个条件没满足都无法跑起，两个条件没有先后顺序。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224637913_zh-CN.png)

应用场景：

导入、统计加工和导出任务，都是天任务，具体时间如上图13：00 。统计加工任务依赖导入任务，导出任务依赖统计加工任务，依赖配置如下图（统计加工任务的依赖属性配置上游任务为导入任务）所示：

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224647914_zh-CN.png)

上图的配置，调度系统会自动为任务生成实例并运行如下：

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224647915_zh-CN.png)

## 周调度 {#section_lz2_btx_p2b .section}

周调度任务，即每周的特定几天里每天在特定时间点自动运行一次。当到了没有被指定的日期时，为保证下游实例正常运行，系统也会生成实例但直接设置为运行成功，而不会真正执行任何逻辑，也不会占用资源。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224647916_zh-CN.png)

如上图所示，每周一、周五两天生成的实例会正常的调度执行，而周二、三、四、六以及周日5天都是生成实例然后直接设置为运行成功。

上图的配置，调度系统会自动为任务生成实例并运行如下：

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224647917_zh-CN.png)

## 月调度 {#section_bgl_j5x_p2b .section}

月调度任务，即每月指定的特定几天里每天在特定时间点自动运行一次。当到了没有被指定的日期时，为保证下游实例正常运行，系统也会每天生成实例但直接设置为运行成功，而不会真正执行任何逻辑，也不会占用资源。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224647918_zh-CN.png)

如上图所示，每月1日生成的实例会正常的调度执行，其他日期每天都是生成实例并直接设为运行成功。

上图的配置，调度系统会自动为任务生成实例并运行如下：

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224647919_zh-CN.png)

## 小时调度 {#section_lfn_1vx_p2b .section}

小时调度任务，即每天指定的时间段内按N\*1小时的时间间隔运行一次，比如每天1 点到4点的时间段内，每1小时运行一次。

**说明：** 时间周期按左闭右闭原则计算，比如配置为从0点到3点的时间段内，每隔1个小时运行一次，表明时间区间为\[00:00，03:00\]，间隔为1小时，调度系统将会每天生成3个实例，分别在0点/1点/2点/3点运行。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224647920_zh-CN.png)

如上图的配置，表示每天00点整到23点59分这个时间段内，每隔6小时会自动调度一次，因此调度系统会自动为任务生成实例并运行如下：

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224647921_zh-CN.png)

## 分钟调度 {#section_s5w_svx_p2b .section}

分钟调度任务，即每天指定的时间段内按N\*指定分钟的时间间隔运行一次，如下图：

每天00:00开始到到23:00这个时间段里每隔30分钟调度一次。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224647922_zh-CN.png)

目前分钟只支持最小5分钟的粒度，时间表达式不能手动修改根据上面时间选择生成。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224647923_zh-CN.png)

**说明：** 关于实时转实例的详细解释，请参见[实时转实例](cn.zh-CN/使用指南/数据开发/调度配置/实时转实例.md#)。

## 常见问题 {#section_q3v_qwx_p2b .section}

Q：我的上游A是小时任务，下游B是日调度，B任务每天在A任务全部执行完成之后要汇总执行一次，这样可以相互依赖吗？

A：日任务依赖小时任务是可以的，A任务配置成小时调度，B任务配置成日调度不定时，配置为上下游依赖（依赖配置请看调度依赖说明），如此每天A任务成功跑完24小时实例之后B任务即可跑起。所以每种周期的任务都可以相互依赖，每个任务的调度周期都是任务本身时间属性决定。

Q：我的需求是A任务每天每小时整点执行一次，B任务每天跑一次，但是希望A任务每天第一次跑成功后B任务就跑起，这样可以怎么配置？

A：A任务配置时，需要勾选“依赖上一周期” 选“本节点”，然后B任务的定时时间为0点，这样每天自动调度实例里B任务实例就只依赖A任务0点实例即A任务第一个实例。

Q:A任务每周一跑一次，B任务依赖A任务，也希望跟A任务一样每周1跑一次怎么配置？

A:B任务的时间属性跟A任务一模一样即可，也就是调度周期也要选“周调度”“周一”。

Q： 任务被删除，实例是否受影响？

A： 当一个任务运行一段时间后被 删除时，由于调度系统每天会按时间属性为该任务生成对应的一个或多个实例，实例不会被删除。因此当这些实例在任务被删除了之后才被触发运行时，会由于找不到需要运行的代码而失败，报错信息如下所示：

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16302/15420224647924_zh-CN.png)

Q：想在每月的最后一天计算当月数据怎么办？

A：目前系统不支持配置每月最后一天，因此如果时间周期选择每月31日，那么在有31日的月份会有一天调度，其他日期都是生成实例然后直接设为运行成功。

需要统计每个月的数据时，建议选择每月的1日运行，计算上个月的数据。

