# 向导模式生成API {#concept_cgn_txh_r2b .concept}

本文将为您介绍如何通过向导模式生成API。

使用向导模式生成数据API操作较为简单，您无需编写任何代码，通过产品界面进行勾选配置即可快速生成API。推荐对API功能的要求不高或者无代码开发经验的用户使用。

**说明：** 配置API前，请在**数据集成** \> **同步资源管理** \> **数据源**页面配置好数据源。

## 配置API基础信息 {#section_qdt_jzh_r2b .section}

1.  登录DataWorks控制台，单击相应工作空间后的**进入数据服务**。
2.  鼠标悬停至**新建**图标，选择**生成API** \> **向导模式**。

    ![向导模式](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16407/156739243854268_zh-CN.png)

3.  填写**生成API**对话框中的配置。

    ![生成API](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16407/15673924388791_zh-CN.png)

    |配置|说明|
    |:-|:-|
    |**API名称**|支持中文、英文、数字、下划线，且只能以英文或中文开头，4~50个字符。|
    |**API分组**|API分组是指针对某一个功能或场景的API集合，也是API网关对API的最小管理单元。在阿里云API市场中，一个API分组对应于一个API商品。 您可以将鼠标悬停至**新建**图标，单击**新建分组**进行新建。

 |
    |**API Path**|API存放的路径，如/user。|
    |**协议**|目前支持HTTP和HTTPS协议。|
    |**请求方式**|目前支持GET和POST请求方式。|
    |**返回类型**|目前仅支持JSON返回类型。|
    |**描述**|对API进行简要描述。|

    **说明：** API分组的设置示例如下：

    例如您要配置一个天气查询的API产品，天气查询API由城市名称查询天气API、景点名称查询天气API和邮编查询天气API三种API组成，那么就可以创建一个名为天气查询的API分组，并把以上三种API放在这个分组中。然后把这个API上架到API市场中销售时，就会呈现为一个天气查询的API产品。

    如果您生成的API是在自己的APP中使用，则可以把分组当作分类来使用。

4.  完成API基础信息的填写后，单击**确认**，即可进入API参数配置页面。

## 配置API参数 {#section_c1n_g13_r2b .section}

1.  选择**数据源类型**、**数据源名称**和**数据表名称**。

    ![选择数据源](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16407/156739243858631_zh-CN.png)

    **说明：** 

    -   您需提前在数据集成中配置好数据源，数据表下拉框支持表名搜索。
    -   创建好API后，会自动跳转至数据表配置页面，您可以直接进行配置。
2.  设置**内存**和**超时时间**。

    ![环境设置](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16408/156739243858590_zh-CN.png)

3.  选择好数据表后，下方的**选择参数**模块会自动列出该表的所有字段。勾选需要**设为请求参数**和**设为返回参数**的字段，分别添加至请求参数和返回参数列表中。

    ![选择参数](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16407/156739243858632_zh-CN.png)

4.  编辑请求参数信息。

    单击右侧的**请求参数**，设置**参数名称**、**参数类型**、**操作符**、**是否必填**、**示例值**、**默认值**和**描述**。

    ![请求参数](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16407/15673924388794_zh-CN.png)

5.  编辑返回参数信息。

    单击右侧的**返回参数**，设置**参数名称**、**参数类型**、**示例值**和**描述**，并可以进行**返回结果分页**和**使用过滤器**等高级配置。

    ![返回参数](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16407/156739243843272_zh-CN.png)

    配置过程中需要注意返回结果分页的设置：

    -   如果不开启**返回结果分页**，则API默认最多返回500条记录。
    -   如果返回结果可能超过500条，请开启**返回结果分页**功能。
    开启返回结果分页后，会自动增加以下公共参数：

    -   公共请求参数
        -   pageNum：当前页号。
        -   pageSize：页面大小，即每页记录数。
    -   公共返回参数
        -   pageNum：当前页号。
        -   pageSize：页面大小，即每页记录数。
        -   totalNum：总记录数。
    **说明：** 

    -   请求参数仅支持等值查询，返回参数仅支持字段值原样输出。
    -   尽量将有索引的字段设置为请求参数。
    -   API允许不设置请求参数，当无请求参数时，则必须开启返回结果分页。
    -   为方便API调用者了解API详情，请尽量设置API参数的示例值、默认值、描述等信息。
    -   单击已配置的API，可以查看当前的表已经生成的API列表，请避免生成同样的API。

## API测试 {#section_d5j_nb3_r2b .section}

完成API参数的配置并保存后，单击右上角的**测试**，即可进入API测试环节。

![API测试](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16407/15673924388797_zh-CN.png)

填写参数值，单击**开始测试**，即可在线发送API请求，在右侧可以看到API请求详情及返回内容。如果测试失败，请仔细查看错误提示并做相应的修改重新测试。

配置过程中需要注意正常返回示例的设置。配置好API之后，系统会自动生成异常返回示例和错误码，但没办法自动生成正常返回示例。需要在开始测试前勾选**保存为正常返回示例**，将当前的测试结果保存为正常返回示例。如果返回结果中有敏感数据需要脱敏，可以手动编辑修改。

![保存为正常返回示例](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/16409/156739243858644_zh-CN.png)

**说明：** 

-   正常返回示例对于API的调用者来说，具有非常重要的参考意义，请务必配置。
-   API调用延迟是本次API请求的延迟，供您评估的API性能。如果延迟较大，则要考虑进行数据库优化。

完成API测试后，返回**服务开发**页面，单击**发布**，即可成功生成一个数据API。

## API详情查看 {#section_xp4_mc3_r2b .section}

回到API服务列表页面，右键单击相应的API服务，选择**详情**，即可查看API的详情信息。API详情页面以调用者的视角展示了API的详细信息。

